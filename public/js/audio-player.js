const songsData = [
  {
    title: "–õ—é–±–∏–º–æ–º—É",
    name: "–í–∏–∫—Ç–æ—Ä–∏—è",
    audio: "https://everyonesing.ru/wp-content/uploads/2025/09/–õ—é–±–∏–º–æ–º—É-–ü–µ—Å–Ω—è.mp3",
    image: "https://everyonesing.ru/wp-content/uploads/2025/09/IMG_6135-974x1024.jpg",
    video: "https://everyonesing.ru/wp-content/uploads/2025/10/IMG_6379.mp4",
    date: "12 –Ω–æ—è–±—Ä—è 2025",
    color: "#EF0105",
    text: "–ú—É–∂ –î–∏–º–∞. –ó–æ–≤—É –µ–≥–æ ‚Äú–ü—É—Å—è‚ÄùüòÅ –ú—ã –≤–º–µ—Å—Ç–µ 4 –≥–æ–¥–∞. –ö–∞–∫ –≤—Å–µ –Ω–∞—á–∞–ª–æ—Å—å: –¢–≤–æ–µ –Ω–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫—É—Ä–∏—à—å –∫–∞–ª—å—è–Ω –∏ –≤–æ—Ç —É–∂–µ —Ç—ã –≤—ã–∑–≤–∞–ª –º–Ω–µ —Ç–∞–∫—Å–∏, –Ω–µ –∑–Ω–∞—è –¥–∞–∂–µ –∏–º–µ–Ω –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –ø–æ—Ç–æ–º —Ç–µ–ª–µ–ø—Ä–æ–µ–∫—Ç, —Å—Å–æ—Ä—ã, —Ä—É–≥–∞–Ω—å, —Ä–∞—Å—Å—Ç–∞–≤–∞–Ω–∏—è, –Ω–æ –º—ã —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å  –ú—ã –ø–µ—Ä–µ–µ–∑–∂–∞–µ–º –≤ –Ω–∞—à—É –Ω–æ–≤—É—é –∫–≤–∞—Ä—Ç–∏—Ä—É —Ä—è–¥–æ–º —Å –ú–æ—Å–∫–≤–æ–π —Å–∏—Ç–∏ –Ø —Å—á–∞—Å—Ç–ª–∏–≤–∞ , —á—Ç–æ –º—ã –ø—Ä–æ—Ö–æ–¥–∏–º —ç—Ç–æ—Ç –ø—É—Ç—å –≤–º–µ—Å—Ç–µ  –ò –º–Ω–æ–≥–æ–µ –µ—â–µ –≤–ø–µ—Ä–µ–¥–∏",
    duration: 0,
  },
  {
    title: "–ù–∞ –°–≤–∞–¥—å–±—É",
    name: "–ù–∞—Ç–∞–ª–∏—è",
    audio: "https://everyonesing.ru/wp-content/uploads/2025/09/–õ—é–±–∏–º–æ–º—É-–ü–µ—Å–Ω—è.mp3",
    image: "https://everyonesing.ru/wp-content/uploads/2025/09/IMG_6137-1024x1024.jpg",
    video: "https://everyonesing.ru/wp-content/uploads/2025/10/IMG_6376.mp4",
    date: "15 –Ω–æ—è–±—Ä—è 2025",
    color: "#FF0C59",
    text: "–î–∞—Ä—é –ø–µ—Å–Ω—é –≤ —á–µ—Å—Ç—å –Ω–∞—à–µ–π —Å–≤–∞–¥—å–±—ã! –†–æ–º–∞. –ú–æ—è –ª—é–±–æ–≤—å –†–∞–±–æ—Ç–∞–µ—Ç –∏–Ω–∂–µ–Ω–µ—Ä–æ–º, –≤—Å–µ —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Å–∞–º–æ–ª–µ—Ç–∞–º–∏. –ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫—Ä–æ—Å—Å–æ–≤–∫–∏ –µ—Å–ª–∏ –≤–¥—Ä—É–≥ —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç üòÖ 266 –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä—É–∫–∏ –∏ —Å–µ—Ä–¥—Ü–∞ –ü–µ—Å–Ω—è –∫–∞–∫ –µ—â–µ –æ–¥–Ω–æ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –≤ –ª—é–±–≤–∏, —Å–ª–æ–≤–∞ –≤–º–µ—Å—Ç–æ –∫–ª—è—Ç–≤—ã ",
    duration: 0,
  },
  {
    title: "–ü–æ–¥—Ä—É–≥–µ",
    name: "–ê–Ω–∞—Å—Ç–∞—Å–∏—è",
    audio: "https://everyonesing.ru/wp-content/uploads/2025/09/–ü–æ–¥—Ä—É–≥–µ-–ü–µ—Å–Ω—è.mp3",
    image: "https://everyonesing.ru/wp-content/uploads/2025/09/IMG_6139-987x1024.jpg",
    video: "https://everyonesing.ru/wp-content/uploads/2025/10/IMG_6378.mp4",
    date: "15 –Ω–æ—è–±—Ä—è 2025",
    color: "#FF4400",
    text: "–Ø–Ω–∞ –û–Ω–∞ –º–∞—Å—Ç–µ—Ä –º–∞–Ω–∏–∫—é—Ä–∞, –∏–Ω–æ–≥–¥–∞ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Å–ø–æ—Ä—Ç–æ–º, –Ω–æ –æ–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–æ –±—Ä–æ—Å–∞–µ—Ç. 10 –ª–µ—Ç –¥—Ä—É–∂–∏–º, —É—á–∏–ª–∏—Å—å –≤–º–µ—Å—Ç–µ –≤ –∫–æ–ª–ª–µ–¥–∂–µ –ó–∞ –≤—Å–µ –≤—Ä–µ–º—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ –º—ã –∂–∏–ª–∏ –∏ –≤ —Ä–∞–∑–Ω—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö, –∏ –≤ –æ–¥–Ω–æ–º –¥–æ–º–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç—Ç–∞–∂–∞—Ö. –ö–æ–≥–¥–∞ –±—ã–ª–∏ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏, –≤—Å–µ —Ä–∞–≤–Ω–æ –≤—Å–µ–≥–¥–∞ –æ–±—â–∞–ª–∏—Å—å –∏ –∂–¥–∞–ª–∏ –≤—Å—Ç—Ä–µ—á–∏. –†–∞–Ω—å—à–µ –º—ã —Ç—É—Å–∏–ª–∏ –≤—Å—é –Ω–æ—á—å, –∞ —Å–µ–π—á–∞—Å –æ–Ω–∞ –ø–æ–º–æ–≥–∞–µ—Ç —É–∫–∞—á–∏–≤–∞—Ç—å –º–æ—é –¥–æ—á–∫—É.",
    duration: 0,
  },
  {
    title: "–ü–µ—Å–Ω—è –∂–µ–Ω–µ",
    name: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä",
    audio: "https://everyonesing.ru/wp-content/uploads/2025/09/–ñ–µ–Ω–µ-–ü–µ—Å–Ω—è.mp3",
    image: "https://everyonesing.ru/wp-content/uploads/2025/09/IMG_6138-1024x1024.jpg",
    video: "https://everyonesing.ru/wp-content/uploads/2025/10/IMG_6377.mp4",
    date: "15 –Ω–æ—è–±—Ä—è 2025",
    color: "#4971FC",
    text: "–ñ–µ–Ω—É –Ω–∞–∑—ã–≤–∞—é –ö—Å–µ–Ω–∏—è, –º–∞–ª—ã—à–∫–∞, –∑–∞—è. –û–Ω–∞ –ø–æ–∫–æ—Ä–∏–ª–∞ –º–µ–Ω—è —Å –ø–µ—Ä–≤–æ–≥–æ –≤–∑–≥–ª—è–¥–∞. –û–Ω–∞ –æ—á–µ–Ω—å –ª–∞—Å–∫–æ–≤–∞—è, –¥–æ–±—Ä–∞—è, –æ—Ç–∑—ã–≤—á–∏–≤–∞—è. –í–º–µ—Å—Ç–µ –º—ã —É–∂–µ 13 –ª–µ—Ç. –•–æ—Ç–µ–ª–∏ —Ä–µ–±–µ–Ω–∫–∞ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ üòÖ–£ –Ω–∞—Å 5 –¥–µ—Ç–µ–π —Å–µ–π—á–∞—Å. 3 –º–∞–ª—å—á–∏–∫–∞ –∏ 2 –¥–µ–≤–æ—á–∫–∏ –•–æ–±–±–∏ , —Ä–∏—Å—É–µ—Ç –∫–∞—Ä—Ç–∏–Ω—ã –ø–æ –Ω–æ–º–µ—Ä–∞–º ü§£ü§£ü§£ –•–æ—á—É –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å –µ–µ –∑–∞ —Ç–æ, —á—Ç–æ –±—ã–ª–∞ –≤—Å–µ–≥–¥–∞ —Ä—è–¥–æ–º –∏ –≤—ã—Ä–∞–∑–∏—Ç—å —á—É–≤—Å—Ç–≤–∞ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏, –Ω–µ–∂–Ω–æ—Å—Ç–∏ –∏ –ª—é–±–≤–∏ –∫ —Å–µ–º—å–µ‚Ä¶",
    duration: 0,
  },
  {
    title: "–ú–∞–º–µ",
    name: "–ê–ª–∏–Ω–∞",
    audio: "https://everyonesing.ru/wp-content/uploads/2025/09/–ú–∞–º–µ-–ü–µ—Å–Ω—è.mp3",
    image: "https://everyonesing.ru/wp-content/uploads/2025/09/IMG_6133-2-1024x1024.jpg",
    video: "https://everyonesing.ru/wp-content/uploads/2025/10/IMG_6371.mp4",
    date: "15 –Ω–æ—è–±—Ä—è 2025",
    color: "#88b58b",
    text: "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –º–∞–º—ã - 55 –ª–µ—Ç. –û–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –ø–µ—Å–Ω–µ - –≠–Ω–∏–µ–º –ó–∞–±–æ—Ç–ª–∏–≤–∞—è, –¥–æ–±—Ä–∞—è, –∏—Å–∫—Ä–µ–Ω–Ω—è—è, –Ω–µ–∂–Ω–∞—è, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è, –ª—é–±—è—â–∞—è, –ª–∞—Å–∫–æ–≤–∞—è, –¥–æ–±—Ä–æ—Å–µ—Ä–¥–µ—á–Ω–∞—è, –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω–∞—è, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è, –≤–µ—Å–µ–ª–∞—è, –∑–∞–∂–∏–≥–∞—Ç–µ–ª—å–Ω–∞—è, –¥—É—à–µ–≤–Ω–∞—è –°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–æ, —á—Ç–æ –ø–æ–¥–∞—Ä–∏–ª–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –≤—Å–µ–≥–¥–∞ –¥–∞–≤–∞–ª–∞ –≤—Å–µ —Å–∞–º–æ–µ –ª—É—á—à–µ–µ, –≤–æ –º–Ω–æ–≥–æ–º –æ—Ç–∫–∞–∑—ã–≤–∞—è —Å–µ–±–µ. –ú–∞–º–∞ –ª—é–±–∏—Ç –∫–∞–∫ –ø–∞–ø–∞ –∏–≥—Ä–∞–µ—Ç –Ω–∞ –≥–∏—Ç–∞—Ä–µ –∏ –ø–æ–µ—Ç –ø–µ—Å–Ω—é ¬´—Ç–∞–Ω—Ü—ã –≤–¥–≤–æ–µ–º¬ª –≥—Ä—É–ø–ø—ã –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è",
    duration: 0,
  },
];

class AudioPlayer {
  constructor(containerSelector) {
    this.container = document.querySelector(containerSelector);
    if (!this.container) {
      console.error(`Container with selector ${containerSelector} not found`);
      return;
    }
    console.log("by @ProKsiKzzz");
    this.currentIndex = 0;
    this.isPlaying = false;
    this.audio = new Audio();
    this.isFullTextVisible = false;
    this.fullText = "";

    this.init();
  }

  init() {
    this.createPlayer();
    this.loadSong(this.currentIndex, false);
    this.bindEvents();
    this.loadAllDurations();

    window.addEventListener("resize", () => this.handleResize());
  }

  createPlayer() {
    this.container.innerHTML = `
      <div class="examples__head">
        <h2 class="examples__head-title">–ü—Ä–∏–º–µ—Ä—ã –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø–µ—Å–µ–Ω</h2>
        <p class="examples__head-text">–£–∂–µ –±–æ–ª–µ–µ 1700 –∏—Å—Ç–æ—Ä–∏–π –ª—é–±–≤–∏, –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏ –∏ –¥—Ä—É–∂–±—ã –º—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ –≤ –ø–µ—Å–Ω–∏</p>
      </div>

      <div class="examples__body">
        <div class="examples__body-decorate" style="background: ${songsData[0].color};"></div>
        <div class="examples__player">
          <div class="examples__player-head">
            <div class="examples__player-preview">
              <img width="134" height="134" class="examples__player-preview-img" src="" alt="–ö–∞—Ä—Ç–∏–Ω–∫–∞">
            </div>
            <div class="examples__player-info">
              <div class="examples__player-title"></div>
              <div class="examples__player-name"></div>
            </div>
          </div>
          <div class="examples__player-timer">
            <div class="examples__player-timer-bar">
              <button class="examples__player-prev" type="button">
                <img src="./public/images/examples/icons/prev.svg" alt="–ü—Ä–µ–¥—ã–¥—É—â–∞—è –ø–µ—Å–Ω—è">
              </button>
              <div class="examples__player-timer-progress">
                <span class="examples__player-timer-progress-line" style="width: 0%;"></span>
              </div>
              <button class="examples__player-next" type="button">
                <img src="./public/images/examples/icons/next.svg" alt="–°–ª–µ–¥—É—é—â–∞—è –ø–µ—Å–Ω—è">
              </button>
            </div>
            <button class="examples__player-timer-button" type="button">
              <img class="examples__player-timer-button-icon _show" src="./public/images/icons/play.svg"
                   alt="–í–∫–ª—é—á–∏—Ç—å –ø–µ—Å–Ω—é">
              <img class="examples__player-timer-button-icon" src="./public/images/icons/pause.svg"
                   alt="–ü–∞—É–∑–∞">
            </button>
          </div>

          <div class="examples__player-sub-title">–î—Ä—É–≥–∏–µ –ø—Ä–∏–º–µ—Ä—ã</div>

          <div class="examples__player-composition-list-wrapper">
            <ul class="examples__player-composition-list"></ul>
          </div>
          <a class="examples__player-button button button_gradient" href="#">
              <img src="./public/images/icons/mic.svg" alt="–ú–∏–∫—Ä–æ—Ñ–æ–Ω">
              –ó–∞–∫–∞–∑–∞—Ç—å –ø–µ—Å–Ω—é
          </a>
        </div>
        <div class="examples__content">
          <h3 class="examples__content-title"></h3>
          <div class="examples__content-inner">
            <div class="examples__content-picture">
              <video width="385" height="452" class="examples__content-video" src="" poster="" alt="–ö–∞—Ä—Ç–∏–Ω–∫–∞" muted playsinline></video>
            </div>
            <div class="examples__content-body">
              <p class="examples__content-text"></p>

              <button class="examples__content-more _show" type="button">
                –ß–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é
              </button>

              <div class="examples__content-date"></div>
            </div>
          </div>
        </div>
      </div>
    `;

    this.playerPreviewImg = this.container.querySelector(
      ".examples__player-preview-img"
    );
    this.playerTitle = this.container.querySelector(".examples__player-title");
    this.playerName = this.container.querySelector(".examples__player-name");
    this.progressBar = this.container.querySelector(
      ".examples__player-timer-progress-line"
    );
    this.timerButton = this.container.querySelector(
      ".examples__player-timer-button"
    );
    const timerIcons = this.container.querySelectorAll(
      ".examples__player-timer-button-icon"
    );
    this.timerPlayIcon = timerIcons[0];
    this.timerPauseIcon = timerIcons[1];

    this.prevButton = this.container.querySelector(".examples__player-prev");
    this.nextButton = this.container.querySelector(".examples__player-next");
    this.compositionList = this.container.querySelector(
      ".examples__player-composition-list"
    );
    this.contentTitle = this.container.querySelector(
      ".examples__content-title"
    );
    this.contentImg = this.container.querySelector(".examples__content-img");
    this.contentVideo = this.container.querySelector(
      ".examples__content-video"
    );
    this.contentText = this.container.querySelector(".examples__content-text");
    this.contentMoreButton = this.container.querySelector(
      ".examples__content-more"
    );
    this.contentDate = this.container.querySelector(".examples__content-date");

    this.renderCompositionList();
  }

  renderCompositionList() {
    this.compositionList.innerHTML = "";
    songsData.forEach((song, index) => {
      const item = document.createElement("li");
      item.className = "examples__player-composition-item";
      item.innerHTML = `
        <button class="examples__player-composition-inner" data-index="${index}">
          <div class="examples__player-composition-cover">
            <img width="53" height="53" class="examples__player-composition-cover-img" src="${song.image}" alt="–ö–∞—Ä—Ç–∏–Ω–∫–∞">
            <div class="examples__player-composition-cover-button">
              <img class="examples__player-composition-cover-button-icon _show" src="./public/images/icons/play.svg" alt="–í–∫–ª—é—á–∏—Ç—å –ø–µ—Å–Ω—é">
              <img class="examples__player-composition-cover-button-icon" src="./public/images/icons/pause.svg" alt="–ü–∞—É–∑–∞">
            </div>
          </div>
          <div class="examples__player-composition-content">
            <div class="examples__player-composition-title">${song.title}</div>
            <div class="examples__player-composition-name">${song.name}</div>
          </div>
          <div class="examples__player-composition-time" data-index="${index}">--:--</div>
        </button>
      `;
      this.compositionList.appendChild(item);
    });

    this.bindCompositionButtons();
    this.updateActiveComposition();
  }

  bindCompositionButtons() {
    const coverButtons = this.container.querySelectorAll(
      ".examples__player-composition-inner"
    );
    coverButtons.forEach((button) => {
      button.addEventListener("click", (e) => {
        const index = parseInt(e.currentTarget.getAttribute("data-index"), 10);

        if (this.currentIndex !== index) {
          this.currentIndex = index;
          this.loadSong(index, true);
          return;
        }

        this.togglePlay();
      });
    });
  }

  updateActiveComposition() {
    const allCompositions = this.container.querySelectorAll(
      ".examples__player-composition-inner"
    );

    allCompositions.forEach((composition, index) => {
      if (index === this.currentIndex) {
        composition.classList.add("_active");
      } else {
        composition.classList.remove("_active");
      }
    });
  }

  bindEvents() {
    this.prevButton.addEventListener("click", () => this.prevSong());
    this.nextButton.addEventListener("click", () => this.nextSong());
    this.timerButton.addEventListener("click", () => {
      this.togglePlay();
    });

    this.audio.addEventListener("timeupdate", () => this.updateProgress());
    this.audio.addEventListener("ended", () => this.nextSong(true));
    this.audio.addEventListener("loadedmetadata", () => {
      this.updateCompositionTimeDisplay(this.currentIndex, this.audio.duration);
    });
  }

  updateCompositionTimeDisplay(index, duration) {
    if (!duration) return;
    const minutes = Math.floor(duration / 60);
    const seconds = Math.floor(duration % 60);
    const durationTimeStr = `${minutes}:${
      seconds < 10 ? "0" + seconds : seconds
    }`;
    const compositionTimeElement = this.container.querySelector(
      `.examples__player-composition-time[data-index="${index}"]`
    );
    if (compositionTimeElement) {
      compositionTimeElement.textContent = durationTimeStr;
    }
  }

  loadSong(index, autoplay = false) {
    const song = songsData[index];
    if (!song) return;

    this.playerPreviewImg.src = song.image;
    this.playerTitle.textContent = song.title;
    this.playerName.textContent = song.name;
    this.contentTitle.textContent = song.name;
    this.contentDate.textContent = song.date;

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏–¥–µ–æ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
    if (song.video) {
      this.contentVideo.src = song.video;
      this.contentVideo.poster = song.image;
      this.contentVideo.style.display = "block";
    } else {
      this.contentVideo.style.display = "none";
      this.contentVideo.src = "";
    }

    const decorateElement = this.container.querySelector(
      ".examples__body-decorate"
    );
    if (decorateElement && song.color) {
      decorateElement.style.background = song.color;
    }

    this.currentSongText = song.text;
    this.updateStoryText(song.text);

    this.audio.src = song.audio;
    this.audio.load();

    if (autoplay) {
      this.audio.play();
      this.isPlaying = true;

      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
      if (song.video) {
        this.contentVideo.muted = true;
        this.contentVideo
          .play()
          .catch((e) =>
            console.log("–í–∏–¥–µ–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:", e)
          );
      }
    } else {
      this.isPlaying = false;
    }

    this.updateUIState();
    this.updateActiveComposition();
  }

  async loadAllDurations() {
    for (let i = 0; i < songsData.length; i++) {
      const song = songsData[i];
      const audio = new Audio();
      await new Promise((resolve) => {
        audio.onloadedmetadata = () => {
          song.duration = audio.duration;
          this.updateCompositionTimeDisplay(i, audio.duration);
          resolve();
        };
        audio.onerror = () => {
          this.updateCompositionTimeDisplay(i, 0);
          resolve();
        };
        audio.src = song.audio;
        audio.load();
      });
    }
  }

  updateStoryText(text) {
    const maxLength = 400;
    if (text.length > maxLength) {
      this.contentText.textContent = text.substring(0, maxLength) + "...";
      this.contentMoreButton.classList.add("_show");

      if (window.innerWidth < 1280) {
        this.contentText.classList.remove("_show");
        this.contentMoreButton.textContent = "–ß–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é";
        this.isFullTextVisible = false;
        this.fullText = text;

        this.contentMoreButton.onclick = () => {
          if (!this.isFullTextVisible) {
            this.contentText.textContent = this.fullText;
            this.contentText.classList.add("_show");
            this.contentMoreButton.textContent = "–°–∫—Ä—ã—Ç—å –∏—Å—Ç–æ—Ä–∏—é";
            this.isFullTextVisible = true;
          } else {
            this.contentText.classList.remove("_show");
            this.contentMoreButton.textContent = "–ß–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é";
            this.isFullTextVisible = false;
          }
        };
      } else {
        this.contentText.classList.add("_show");
        this.contentMoreButton.textContent = "–ß–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é";
        this.isFullTextVisible = false;
        this.fullText = text;

        this.contentMoreButton.onclick = () => {
          if (!this.isFullTextVisible) {
            this.contentText.textContent = this.fullText;
            this.contentMoreButton.textContent = "–°–∫—Ä—ã—Ç—å –∏—Å—Ç–æ—Ä–∏—é";
            this.isFullTextVisible = true;
          } else {
            this.contentText.textContent = text.substring(0, maxLength) + "...";
            this.contentMoreButton.textContent = "–ß–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é";
            this.isFullTextVisible = false;
          }
        };
      }
    } else {
      this.contentText.textContent = text;
      this.contentMoreButton.classList.remove("_show");
      this.contentText.classList.add("_show");
      this.contentMoreButton.onclick = null;

      if (window.innerWidth < 1280) {
        this.contentText.classList.remove("_show");
        this.contentMoreButton.classList.add("_show");
        this.contentMoreButton.textContent = "–ß–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é";
        this.isFullTextVisible = false;
        this.fullText = text;

        this.contentMoreButton.onclick = () => {
          if (!this.isFullTextVisible) {
            this.contentText.textContent = this.fullText;
            this.contentText.classList.add("_show");
            this.contentMoreButton.textContent = "–°–∫—Ä—ã—Ç—å –∏—Å—Ç–æ—Ä–∏—é";
            this.isFullTextVisible = true;
          } else {
            this.contentText.classList.remove("_show");
            this.contentMoreButton.textContent = "–ß–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é";
            this.isFullTextVisible = false;
          }
        };
      }
    }
  }

  updateUIState() {
    const allButtons = this.container.querySelectorAll(
      ".examples__player-composition-inner"
    );

    allButtons.forEach((button) => {
      const index = parseInt(button.getAttribute("data-index"), 10);
      const icons = button.querySelectorAll(
        ".examples__player-composition-cover-button-icon"
      );
      const playIcon = icons[0];
      const pauseIcon = icons[1];

      playIcon.classList.add("_show");
      pauseIcon.classList.remove("_show");

      if (index === this.currentIndex && this.isPlaying) {
        playIcon.classList.remove("_show");
        pauseIcon.classList.add("_show");
      }
    });

    if (this.isPlaying) {
      this.timerPlayIcon.classList.remove("_show");
      this.timerPauseIcon.classList.add("_show");
    } else {
      this.timerPlayIcon.classList.add("_show");
      this.timerPauseIcon.classList.remove("_show");
    }
  }

  togglePlay() {
    if (this.audio.paused) {
      this.audio.play();
      this.isPlaying = true;

      // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
      const currentSong = songsData[this.currentIndex];
      if (currentSong && currentSong.video) {
        this.contentVideo.muted = true;
        this.contentVideo
          .play()
          .catch((e) => console.log("–í–∏–¥–µ–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ:", e));
      }
    } else {
      this.audio.pause();
      this.isPlaying = false;

      // –ü–∞—É–∑–∞ –≤–∏–¥–µ–æ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
      const currentSong = songsData[this.currentIndex];
      if (currentSong && currentSong.video) {
        this.contentVideo.pause();
      }
    }
    this.updateUIState();
  }

  prevSong(fromEnded = false) {
    this.currentIndex =
      (this.currentIndex - 1 + songsData.length) % songsData.length;
    const shouldAutoplay = this.isPlaying || fromEnded;
    this.loadSong(this.currentIndex, shouldAutoplay);
  }

  nextSong(fromEnded = false) {
    this.currentIndex = (this.currentIndex + 1) % songsData.length;
    const shouldAutoplay = this.isPlaying || fromEnded;
    this.loadSong(this.currentIndex, shouldAutoplay);
  }

  updateProgress() {
    const percent = (this.audio.currentTime / this.audio.duration) * 100;
    this.progressBar.style.width = `${percent || 0}%`;
  }

  handleResize() {
    if (this.currentSongText) {
      this.updateStoryText(this.currentSongText);
    }
  }
}

document.addEventListener("DOMContentLoaded", () => {
  const playerContainer = document.querySelector(".examples");
  if (playerContainer) {
    new AudioPlayer(".examples");
  }
});
